import{h as y,_ as A}from"./staricon.0523acfd.js";import{_ as b,a as v}from"./line1.79af986b.js";import{_ as k}from"./townhall-quiet.bad14889.js";import{_ as x,o as a,c,a as o,q as u,h,F as _,d as C,g,t as i}from"./vendor.395bafa6.js";const w={name:"Proposal",data(){return{slug:this.$route.params.slug,index:"",date:"",announcements:[]}},computed:{role(){return this.$parent.$parent.role}},created(){this.$parent.$parent.tag="a",this.getAnnouncementList("all")},mounted(){},methods:{trimmedAccountAddress(e){return e.length>10?e.slice(0,5)+"..."+e.slice(e.length-5,e.length):e},trimmedAccountNameAndLowercase(e){let t=e.replace(/[, ]+/g,"").trim().toLowerCase();return t.length>12?t.slice(0,9)+"..."+t.slice(t.length-4,t.length):t},trimmedAnnounceTitle(e){return e.length>38?e.slice(0,40)+"...":e},trimmedAnnounceSummary(e){return e.length>334?e.slice(0,334)+"...":e},goAnnounceDetail(e){this.$router.push(`/announcement/detail/${e}`)},getDateString(e){const t=["January","February","March","April","May","June","July","August","September","October","November","December"];let r=new Date(e);const m=("0"+r.getDate()).slice(-2),l=t[r.getMonth()],s=r.getFullYear();return`${m} ${l} ${s}`},goCreateAnnouncement(){this.$router.push(`/announcement/create/${this.slug}`)},getAnnouncementList(e){this.index=e,api.getAnnouncementList({slug:this.slug,index:this.index},t=>{this.announcements=t.data.list,this.announcements.map((r,m)=>{var l=new Date(r.expire_at);let s=y().utcOffset(r.timezone.offset).utcOffset()*60*1e3,n=l.getTime()-s,d=new Date,f=d.getTimezoneOffset()*60*1e3,p=d.getTime()-f;n>p?r.passed=!1:r.passed=!0}),console.log(this.announcements)},t=>{console.log(t)})}}},T={class:"head p-2",style:{width:"100%"}},L=o("span",{class:"px-3 py-1 fs-5 fw-bolder",style:{"border-right":"2px solid #959595"}},"Announcement",-1),D={class:"options"},N={key:0,class:"right-button-holder"},O={key:0,class:"right-section-content",style:{height:"73.8vh","overflow-y":"scroll"}},j=["onClick"],S={class:"header"},V={class:"fw-bolder text-dark",style:{"font-size":"22px"}},z={key:0,class:"mb-1",src:A},B={key:0,class:"status complete",style:{"justify-content":"center","vertical-align":"middle",display:"inline-table"}},F={key:1,class:"status active",style:{"justify-content":"center","vertical-align":"middle",display:"inline-table"}},J={class:"fw-bolder"},M={class:"text-dark",style:{height:"100px"}},q={class:"valid-till"},$=o("img",{src:b},null,-1),E=g("Valid Till \xA0"),I=o("img",{src:v,style:{height:"20px"}},null,-1),P={key:1,class:"right-section-no-content"},U=o("img",{src:k},null,-1),Y=o("span",null,"There are no announcements currently. Let\u2019s wait for someone to broadcast. ",-1),G=[U,Y];function H(e,t,r,m,l,s){return a(),c(_,null,[o("div",T,[L,o("div",D,[o("button",{onClick:t[0]||(t[0]=n=>s.getAnnouncementList("all")),class:u(l.index==="all"?"selected":""),style:{"background-color":"#fff"}},"All",2),o("button",{onClick:t[1]||(t[1]=n=>s.getAnnouncementList("open")),class:u(l.index==="open"?"selected":""),style:{"background-color":"#fff"}},"Open",2),o("button",{onClick:t[2]||(t[2]=n=>s.getAnnouncementList("important")),class:u(l.index==="important"?"selected":""),style:{"background-color":"#fff"}},"Important",2),o("button",{onClick:t[3]||(t[3]=n=>s.getAnnouncementList("closed")),class:u(l.index==="closed"?"selected":""),style:{"background-color":"#fff"}},"Closed",2)]),s.role<2?(a(),c("div",N,[o("button",{onClick:t[4]||(t[4]=(...n)=>s.goCreateAnnouncement&&s.goCreateAnnouncement(...n)),class:"right-button"},"+ Broadcast Announcement")])):h("",!0)]),l.announcements.length>0?(a(),c("div",O,[(a(!0),c(_,null,C(l.announcements,n=>(a(),c("div",{onClick:d=>s.goAnnounceDetail(n._id),class:"block-container-announcement"},[o("div",S,[o("span",V,[g(i(s.trimmedAnnounceTitle(n.title))+" ",1),n.importance?(a(),c("img",z)):h("",!0)]),n.passed?(a(),c("span",B,"closed")):(a(),c("span",F,"open"))]),o("span",J,"Broadcast by "+i(n.creator.name?s.trimmedAccountNameAndLowercase(n.creator.name)+"."+n.slug:s.trimmedAccountAddress(n.creator.address)),1),o("span",M,i(s.trimmedAnnounceSummary(n.summary)),1),o("span",q,[$,E,I,g(" "+i(s.getDateString(n.expire_at))+" ("+i("UTC "+n.timezone.offset)+")",1)])],8,j))),256))])):(a(),c("div",P,G))],64)}var X=x(w,[["render",H]]);export{X as default};
